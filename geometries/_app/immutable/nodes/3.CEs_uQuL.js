import{s as q,d as w,A as G,i as C,x as k,f as b,h as S,l as $,e as x,j as L,k as H,t as R,m as I,z as F}from"../chunks/Bg6b8eG2.js";import{S as J,i as N,t as z,a as P,c as K,d as Q,m as U,e as Z,b as tt,g as et}from"../chunks/Dw1Mgn7V.js";import{e as O,g as nt,P as st}from"../chunks/D6924oQB.js";const ot=!0,mt=Object.freeze(Object.defineProperty({__proto__:null,prerender:ot},Symbol.toStringTag,{value:"Module"})),{Boolean:at}=nt;function T(i,o,r){const l=i.slice();return l[4]=o[r].dataPath,l[5]=o[r].countPath,l[6]=o,l[7]=r,l}function A(i){let o,r,l=i[4].replace(/-top1000\.json$/,"")+"",s,f,n,a=i[7],e,t;const h=()=>i[3](n,a),d=()=>i[3](null,a);let m={sketch:i[2](i[4],i[5])};return n=new st({props:m}),h(),{c(){o=$("div"),r=$("div"),s=R(l),f=I(),tt(n.$$.fragment),e=I(),this.h()},l(c){o=b(c,"DIV",{class:!0});var u=S(o);r=b(u,"DIV",{class:!0});var _=S(r);s=L(_,l),_.forEach(w),f=H(u),Z(n.$$.fragment,u),e=H(u),u.forEach(w),this.h()},h(){k(r,"class","viz-title svelte-1t43we1"),k(o,"class","viz-column svelte-1t43we1")},m(c,u){C(c,o,u),x(o,r),x(r,s),x(o,f),U(n,o,null),x(o,e),t=!0},p(c,u){a!==c[7]&&(d(),a=c[7],h());const _={};n.$set(_)},i(c){t||(P(n.$$.fragment,c),t=!0)},o(c){z(n.$$.fragment,c),t=!1},d(c){c&&w(o),d(),Q(n)}}}function lt(i){let o,r,l=O(i[1]),s=[];for(let n=0;n<l.length;n+=1)s[n]=A(T(i,l,n));const f=n=>z(s[n],1,1,()=>{s[n]=null});return{c(){o=$("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){o=b(n,"DIV",{class:!0});var a=S(o);for(let e=0;e<s.length;e+=1)s[e].l(a);a.forEach(w),this.h()},h(){k(o,"class","viz-multi svelte-1t43we1")},m(n,a){C(n,o,a);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(o,null);r=!0},p(n,[a]){if(a&7){l=O(n[1]);let e;for(e=0;e<l.length;e+=1){const t=T(n,l,e);s[e]?(s[e].p(t,a),P(s[e],1)):(s[e]=A(t),s[e].c(),P(s[e],1),s[e].m(o,null))}for(et(),e=l.length;e<s.length;e+=1)f(e);K()}},i(n){if(!r){for(let a=0;a<l.length;a+=1)P(s[a]);r=!0}},o(n){s=s.filter(at);for(let a=0;a<s.length;a+=1)z(s[a]);r=!1},d(n){n&&w(o),G(s,n)}}}const rt=6;function it(i){const o=i.reduce((e,t)=>e+t.x,0)/i.length,r=i.reduce((e,t)=>e+t.y,0)/i.length;let l=0,s=0,f=0;i.forEach(e=>{const t=e.x-o,h=e.y-r;l+=t*t,s+=t*h,f+=h*h});let n=.5*Math.atan2(2*s,l-f);const a=i.map(e=>{const t=e.x-o,h=e.y-r,d=t*Math.cos(-n)-h*Math.sin(-n),m=t*Math.sin(-n)+h*Math.cos(-n);return d>0?m:null}).filter(e=>e!==null);return a.length&&a.reduce((e,t)=>e+t,0)/a.length<0&&(n+=Math.PI),{angle:n,center:{x:o,y:r}}}function ct(i,o,r){const l=i.x-r.x,s=i.y-r.y;return{x:l*Math.cos(-o)-s*Math.sin(-o)+r.x,y:l*Math.sin(-o)+s*Math.cos(-o)+r.y}}function ht(i,o,r){const l=[{dataPath:"TP 261 Markt Hall-top1000.json",countPath:"TP 261 Markt Hall-top1000-count.json"},{dataPath:"TP 255 Serpentine Gallery Pavilion-top1000.json",countPath:"TP 255 Serpentine Gallery Pavilion-top1000-count.json"}];let s=Array(l.length).fill(null);const f=(a,e)=>t=>{let h=[];t.preload=()=>{t.loadJSON(a,d=>{h=Object.entries(d).map(([m,c])=>{if(!Array.isArray(c.vertices)||c.vertices.length<rt)return null;const{angle:u,center:_}=it(c.vertices),g=c.vertices.map(p=>ct(p,u,_)),v=g.map(p=>p.x),M=g.map(p=>p.y),y={minX:Math.min(...v),minY:Math.min(...M),w:Math.max(...v)-Math.min(...v),h:Math.max(...M)-Math.min(...M)};return{id:m,verts:g,bounds:y}}).filter(Boolean).sort((m,c)=>c.verts.length-m.verts.length)})},t.setup=()=>{t.createCanvas(t.windowWidth/l.length,t.windowHeight-30),t.noLoop()},t.draw=()=>{if(t.background(255),!h.length)return;const d=Math.ceil(Math.sqrt(h.length*(t.width/t.height))),m=Math.ceil(h.length/d),c=t.width/d,u=t.height/m,_=.75;for(let g=0;g<h.length;g++){const v=h[g],{verts:M,bounds:y}=v,p=g%d,V=Math.floor(g/d),W=p*c+c/2,Y=V*u+u/2,B=Math.max(y.w,y.h),j=Math.min(c,u)*_/B;t.push(),t.translate(W,Y),t.stroke(0),t.strokeWeight(.5),t.noFill(),t.noStroke(),t.fill("blue"),t.beginShape(),M.forEach(E=>{const D=(E.x-(y.minX+y.w/2))*j,X=(E.y-(y.minY+y.h/2))*j;t.vertex(D,X)}),t.endShape(t.CLOSE),t.pop()}},t.windowResized=()=>{t.resizeCanvas(t.windowWidth/l.length,t.windowHeight-30),t.redraw()}};function n(a,e){F[a?"unshift":"push"](()=>{s[e]=a,r(0,s)})}return[s,l,f,n]}class gt extends J{constructor(o){super(),N(this,o,ht,lt,q,{})}}export{gt as component,mt as universal};
