import{s as Q,d as P,A as U,i as Y,x as A,f as V,h as j,l as D,e as $,j as Z,k as O,t as tt,m as R,z as et}from"../chunks/Bg6b8eG2.js";import{S as nt,i as at,t as T,a as z,c as st,d as ot,m as rt,e as lt,b as it,g as ct}from"../chunks/Dw1Mgn7V.js";import{e as C,g as ht,P as ut}from"../chunks/D6924oQB.js";const mt=!0,St=Object.freeze(Object.defineProperty({__proto__:null,prerender:mt},Symbol.toStringTag,{value:"Module"})),{Boolean:dt}=ht;function H(r,s,o){const i=r.slice();return i[4]=s[o].dataPath,i[5]=s[o].countPath,i[6]=s,i[7]=o,i}function W(r){let s,o,i=r[4].replace(/-top1000\.json$/,"")+"",a,h,n,l=r[7],e,t;const c=()=>r[3](n,l),v=()=>r[3](null,l);let S={sketch:r[2](r[4],r[5])};return n=new ut({props:S}),c(),{c(){s=D("div"),o=D("div"),a=tt(i),h=R(),it(n.$$.fragment),e=R(),this.h()},l(u){s=V(u,"DIV",{class:!0});var m=j(s);o=V(m,"DIV",{class:!0});var f=j(o);a=Z(f,i),f.forEach(P),h=O(m),lt(n.$$.fragment,m),e=O(m),m.forEach(P),this.h()},h(){A(o,"class","viz-title svelte-3gu8pf"),A(s,"class","viz-column svelte-3gu8pf")},m(u,m){Y(u,s,m),$(s,o),$(o,a),$(s,h),rt(n,s,null),$(s,e),t=!0},p(u,m){l!==u[7]&&(v(),l=u[7],c());const f={};n.$set(f)},i(u){t||(z(n.$$.fragment,u),t=!0)},o(u){T(n.$$.fragment,u),t=!1},d(u){u&&P(s),v(),ot(n)}}}function ft(r){let s,o,i=C(r[1]),a=[];for(let n=0;n<i.length;n+=1)a[n]=W(H(r,i,n));const h=n=>T(a[n],1,1,()=>{a[n]=null});return{c(){s=D("div");for(let n=0;n<a.length;n+=1)a[n].c();this.h()},l(n){s=V(n,"DIV",{class:!0});var l=j(s);for(let e=0;e<a.length;e+=1)a[e].l(l);l.forEach(P),this.h()},h(){A(s,"class","viz-multi svelte-3gu8pf")},m(n,l){Y(n,s,l);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(s,null);o=!0},p(n,[l]){if(l&7){i=C(n[1]);let e;for(e=0;e<i.length;e+=1){const t=H(n,i,e);a[e]?(a[e].p(t,l),z(a[e],1)):(a[e]=W(t),a[e].c(),z(a[e],1),a[e].m(s,null))}for(ct(),e=i.length;e<a.length;e+=1)h(e);st()}},i(n){if(!o){for(let l=0;l<i.length;l+=1)z(a[l]);o=!0}},o(n){a=a.filter(dt);for(let l=0;l<a.length;l+=1)T(a[l]);o=!1},d(n){n&&P(s),U(a,n)}}}function gt(r){const s=r.reduce((e,t)=>e+t.x,0)/r.length,o=r.reduce((e,t)=>e+t.y,0)/r.length;let i=0,a=0,h=0;r.forEach(e=>{const t=e.x-s,c=e.y-o;i+=t*t,a+=t*c,h+=c*c});let n=.5*Math.atan2(2*a,i-h);const l=r.map(e=>{const t=e.x-s,c=e.y-o,v=t*Math.cos(-n)-c*Math.sin(-n),S=t*Math.sin(-n)+c*Math.cos(-n);return v>0?S:null}).filter(e=>e!==null);return l.length&&l.reduce((e,t)=>e+t,0)/l.length<0&&(n+=Math.PI),{angle:n,center:{x:s,y:o}}}function _t(r,s,o){const i=r.x-o.x,a=r.y-o.y;return{x:i*Math.cos(-s)-a*Math.sin(-s)+o.x,y:i*Math.sin(-s)+a*Math.cos(-s)+o.y}}function pt(r,s=128){const o=r.length;return Array.from({length:s},(i,a)=>{const h=a*o/s,n=Math.floor(h),l=(n+1)%o,e=h-n,t=r[n].x*(1-e)+r[l].x*e,c=r[n].y*(1-e)+r[l].y*e;return{x:t,y:c}})}function xt(r,s,o){return r.map((i,a)=>{const h=s[a];return{x:i.x*(1-o)+h.x*o,y:i.y*(1-o)+h.y*o}})}function yt(r,s,o){const i=[{dataPath:"TP 261 Markt Hall-top1000.json",countPath:"TP 261 Markt Hall-top1000-count.json"},{dataPath:"TP 255 Serpentine Gallery Pavilion-top1000.json",countPath:"TP 255 Serpentine Gallery Pavilion-top1000-count.json"}];let a=Array(i.length).fill(null);const h=(l,e)=>t=>{let c=[],u=0,m=1,f=0;const L=.01,N=.8,X=100,G=1900;let B=1;t.preload=()=>{t.loadJSON(l,E=>{c=Object.entries(E).map(([x,g])=>{if(!Array.isArray(g.vertices)||g.vertices.length<3)return null;const{angle:w,center:b}=gt(g.vertices),_=g.vertices.map(d=>_t(d,w,b)),y=_.map(d=>d.x),p=_.map(d=>d.y),k={minX:Math.min(...y),minY:Math.min(...p),w:Math.max(...y)-Math.min(...y),h:Math.max(...p)-Math.min(...p)};return{id:x,verts:_,resampledVerts:pt(_,128),bounds:k}}).filter(Boolean),B=Math.max(...c.map(x=>Math.max(x.bounds.w,x.bounds.h)),1)})},t.setup=()=>{t.createCanvas(t.windowWidth/i.length,t.windowHeight-30),t.frameRate(60)},t.draw=()=>{if(t.background(255,30),c.length<2)return;f+=L,f>=1&&(f=0,u=m,m=(m+1+Math.floor(Math.random()*(c.length-1)))%c.length,u===m&&(m=(m+1)%c.length));const E=c[u].resampledVerts,x=c[m].resampledVerts,g=xt(E,x,f),w=g.map(M=>M.x),b=g.map(M=>M.y),_=Math.min(...w),y=Math.max(...w),p=Math.min(...b),k=Math.max(...b),d=Math.max(y-_,k-p),q=Math.min(t.width,t.height)*N,I=t.constrain(q/d,X/d,G/d),F=t.constrain(B/d,.2,1);t.push(),t.translate(t.width/2,t.height/2),t.stroke(0),t.strokeWeight(F),t.noFill(),t.beginShape(),g.forEach(M=>{const J=(M.x-(_+(y-_)/2))*I,K=(M.y-(p+(k-p)/2))*I;t.vertex(J,K)}),t.endShape(t.CLOSE),t.pop()},t.windowResized=()=>{t.resizeCanvas(t.windowWidth/i.length,t.windowHeight-30)}};function n(l,e){et[l?"unshift":"push"](()=>{a[e]=l,o(0,a)})}return[a,i,h,n]}class wt extends nt{constructor(s){super(),at(this,s,yt,ft,Q,{})}}export{wt as component,St as universal};
