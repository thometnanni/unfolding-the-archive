import{s as W,d as j,A as U,b as K,i as O,e as T,B as Q,x as E,f as B,h as H,j as X,k as F,l as A,t as L,m as I,n as Z}from"../chunks/Bg6b8eG2.js";import{S as tt,i as et,t as z,a as C,c as G,g as N,d as nt,m as at,e as ot,b as st}from"../chunks/Dw1Mgn7V.js";import{e as V,g as lt,P as it}from"../chunks/D6924oQB.js";const rt=!0,wt=Object.freeze(Object.defineProperty({__proto__:null,prerender:rt},Symbol.toStringTag,{value:"Module"})),{Boolean:ct}=lt;function Y(r,n,l){const a=r.slice();return a[4]=n[l].dataPath,a[5]=n[l].countPath,a[7]=l,a}function D(r){let n,l;return n=new it({props:{sketch:r[2](r[4],r[5],r[0])}}),{c(){st(n.$$.fragment)},l(a){ot(n.$$.fragment,a)},m(a,c){at(n,a,c),l=!0},p(a,c){const u={};c&1&&(u.sketch=a[2](a[4],a[5],a[0])),n.$set(u)},i(a){l||(C(n.$$.fragment,a),l=!0)},o(a){z(n.$$.fragment,a),l=!1},d(a){nt(n,a)}}}function R(r){let n,l,a=r[4].replace(/-top1000\.json$/,"")+"",c,u,m=r[0],_,h,o=D(r);return{c(){n=A("div"),l=A("div"),c=L(a),u=I(),o.c(),_=I(),this.h()},l(e){n=B(e,"DIV",{class:!0});var d=H(n);l=B(d,"DIV",{class:!0});var s=H(l);c=X(s,a),s.forEach(j),u=F(d),o.l(d),_=F(d),d.forEach(j),this.h()},h(){E(l,"class","viz-title svelte-1ip4v67"),E(n,"class","viz-column svelte-1ip4v67")},m(e,d){O(e,n,d),T(n,l),T(l,c),T(n,u),o.m(n,null),T(n,_),h=!0},p(e,d){d&1&&W(m,m=e[0])?(N(),z(o,1,1,Z),G(),o=D(e),o.c(),C(o,1),o.m(n,_)):o.p(e,d)},i(e){h||(C(o),h=!0)},o(e){z(o),h=!1},d(e){e&&j(n),o.d(e)}}}function ht(r){let n,l=r[0]?"Show Animation":"Show Overview",a,c,u,m,_,h,o=V(r[1]),e=[];for(let s=0;s<o.length;s+=1)e[s]=R(Y(r,o,s));const d=s=>z(e[s],1,1,()=>{e[s]=null});return{c(){n=A("button"),a=L(l),c=I(),u=A("div");for(let s=0;s<e.length;s+=1)e[s].c();this.h()},l(s){n=B(s,"BUTTON",{class:!0});var t=H(n);a=X(t,l),t.forEach(j),c=F(s),u=B(s,"DIV",{class:!0});var i=H(u);for(let f=0;f<e.length;f+=1)e[f].l(i);i.forEach(j),this.h()},h(){E(n,"class","toggle-btn svelte-1ip4v67"),E(u,"class","viz-multi svelte-1ip4v67")},m(s,t){O(s,n,t),T(n,a),O(s,c,t),O(s,u,t);for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(u,null);m=!0,_||(h=Q(n,"click",r[3]),_=!0)},p(s,[t]){if((!m||t&1)&&l!==(l=s[0]?"Show Animation":"Show Overview")&&K(a,l),t&7){o=V(s[1]);let i;for(i=0;i<o.length;i+=1){const f=Y(s,o,i);e[i]?(e[i].p(f,t),C(e[i],1)):(e[i]=R(f),e[i].c(),C(e[i],1),e[i].m(u,null))}for(N(),i=o.length;i<e.length;i+=1)d(i);G()}},i(s){if(!m){for(let t=0;t<o.length;t+=1)C(e[t]);m=!0}},o(s){e=e.filter(ct);for(let t=0;t<e.length;t+=1)z(e[t]);m=!1},d(s){s&&(j(n),j(c),j(u)),U(e,s),_=!1,h()}}}const ut=2,dt=5;function mt(r){const n=r.reduce((h,o)=>h+o.x,0)/r.length,l=r.reduce((h,o)=>h+o.y,0)/r.length;let a=0,c=0,u=0;r.forEach(h=>{const o=h.x-n,e=h.y-l;a+=o*o,c+=o*e,u+=e*e});let m=.5*Math.atan2(2*c,a-u);const _=r.map(h=>{const o=h.x-n,e=h.y-l,d=o*Math.cos(-m)-e*Math.sin(-m),s=o*Math.sin(-m)+e*Math.cos(-m);return d>0?s:null}).filter(h=>h!==null);return _.length&&_.reduce((h,o)=>h+o,0)/_.length<0&&(m+=Math.PI),{angle:m,center:{x:n,y:l}}}function ft(r,n,l){const a=r.x-l.x,c=r.y-l.y;return{x:a*Math.cos(-n)-c*Math.sin(-n)+l.x,y:a*Math.sin(-n)+c*Math.cos(-n)+l.y}}function _t(r,n,l){const a=[{dataPath:"TP 261 Markt Hall-top1000.json",countPath:"TP 261 Markt Hall-top1000-count.json"},{dataPath:"TP_255_Serpentine__Research_-top1000.json",countPath:"TP_255_Serpentine__Research_-top1000-count.json"},{dataPath:"TP_377_Boijmans-top1000.json",countPath:"TP_377_Boijmans-top1000-count.json"},{dataPath:"TP_255_Serpentine_Gallery_Pavilion-top1000.json",countPath:"TP_255_Serpentine_Gallery_Pavilion-top1000-count.json"}];let c=!1;function u(_,h,o){let e=[],d=0,s=0;return t=>{t.preload=()=>{t.loadJSON(_,i=>{e=Object.entries(i).map(([g,v])=>{if(!Array.isArray(v.vertices)||v.vertices.length<ut)return null;const{angle:w,center:P}=mt(v.vertices),y=v.vertices.map($=>ft($,w,P)),x=y.map($=>$.x),p=y.map($=>$.y),b={minX:Math.min(...x),minY:Math.min(...p),w:Math.max(...x)-Math.min(...x),h:Math.max(...p)-Math.min(...p)};if(b.w===0&&b.h===0)return null;const k=Math.max(b.w,b.h);return{id:g,verts:y,bounds:b,dim:k}}).filter(Boolean).sort((g,v)=>v.dim-g.dim);let f=e.map(g=>g.dim).sort((g,v)=>g-v),M=Math.floor(.98*(f.length-1));f[M]})},t.setup=()=>{t.createCanvas(t.windowWidth/a.length,t.windowHeight-30),o?t.noLoop():t.loop()},t.draw=()=>{if(t.background(0,0,0),!!e.length)if(o){const S=t.width/10;let M=Array(10).fill(0),g=[];for(let w=0;w<e.length;w++){const P=e[w],y=S*(1-.09)/P.bounds.w,x=P.bounds.h*y+S*.09;let p=M.indexOf(Math.min(...M)),b=p*S+S/2,k=M[p]+x/2;g.push({x:b,y:k,shape:P,shapeH:x,shapeScale:y}),M[p]+=x}const v=Math.max(...M);t.height!==v&&t.resizeCanvas(t.width,v,!0);for(let w=0;w<g.length;w++){const{x:P,y,shape:x,shapeScale:p}=g[w],{verts:b,bounds:k}=x;t.push(),t.translate(P,y),t.strokeWeight(1),t.noFill(),t.fill("white"),t.stroke("white"),t.beginShape(),b.forEach($=>{const q=($.x-(k.minX+k.w/2))*p,J=($.y-(k.minY+k.h/2))*p;t.vertex(q,J)}),t.endShape(t.CLOSE),t.pop()}}else{t.frameCount-s>dt&&(d=(d+1)%e.length,s=t.frameCount);const{verts:i,bounds:f}=e[d],S=Math.max(f.w,f.h),M=.9,g=300,v=1200,w=Math.min(t.width,t.height)*M,P=t.constrain(w/S,g/S,v/S);t.push(),t.translate(t.width/2,t.height/2),t.stroke("white"),t.fill("white"),t.beginShape(),i.forEach(y=>{const x=(y.x-(f.minX+f.w/2))*P,p=(y.y-(f.minY+f.h/2))*P;t.vertex(x,p)}),t.endShape(t.CLOSE),t.pop()}},t.windowResized=()=>{t.resizeCanvas(t.windowWidth/a.length,t.windowHeight-30),t.redraw()}}}function m(){l(0,c=!c)}return[c,a,u,m]}class yt extends tt{constructor(n){super(),et(this,n,_t,ht,W,{})}}export{yt as component,wt as universal};
