import{s as Y,d as w,A as G,i as B,x as j,f as C,h as E,l as I,e as b,j as R,k as A,t as X,m as D,z as q}from"../chunks/Bg6b8eG2.js";import{S as J,i as L,t as O,a as k,c as N,d as K,m as Q,e as U,b as Z,g as tt}from"../chunks/Dw1Mgn7V.js";import{e as H,g as et,P as nt}from"../chunks/D6924oQB.js";const at=!0,mt=Object.freeze(Object.defineProperty({__proto__:null,prerender:at},Symbol.toStringTag,{value:"Module"})),{Boolean:st}=et;function V(r,s,i){const l=r.slice();return l[4]=s[i].dataPath,l[5]=s[i].countPath,l[6]=s,l[7]=i,l}function W(r){let s,i,l=r[4].replace(/-top1000\.json$/,"")+"",a,d,n,o=r[7],e,t;const c=()=>r[3](n,o),g=()=>r[3](null,o);let _={sketch:r[2](r[4],r[5])};return n=new nt({props:_}),c(),{c(){s=I("div"),i=I("div"),a=X(l),d=D(),Z(n.$$.fragment),e=D(),this.h()},l(h){s=C(h,"DIV",{class:!0});var m=E(s);i=C(m,"DIV",{class:!0});var y=E(i);a=R(y,l),y.forEach(w),d=A(m),U(n.$$.fragment,m),e=A(m),m.forEach(w),this.h()},h(){j(i,"class","viz-title svelte-3gu8pf"),j(s,"class","viz-column svelte-3gu8pf")},m(h,m){B(h,s,m),b(s,i),b(i,a),b(s,d),Q(n,s,null),b(s,e),t=!0},p(h,m){o!==h[7]&&(g(),o=h[7],c());const y={};n.$set(y)},i(h){t||(k(n.$$.fragment,h),t=!0)},o(h){O(n.$$.fragment,h),t=!1},d(h){h&&w(s),g(),K(n)}}}function ot(r){let s,i,l=H(r[1]),a=[];for(let n=0;n<l.length;n+=1)a[n]=W(V(r,l,n));const d=n=>O(a[n],1,1,()=>{a[n]=null});return{c(){s=I("div");for(let n=0;n<a.length;n+=1)a[n].c();this.h()},l(n){s=C(n,"DIV",{class:!0});var o=E(s);for(let e=0;e<a.length;e+=1)a[e].l(o);o.forEach(w),this.h()},h(){j(s,"class","viz-multi svelte-3gu8pf")},m(n,o){B(n,s,o);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(s,null);i=!0},p(n,[o]){if(o&7){l=H(n[1]);let e;for(e=0;e<l.length;e+=1){const t=V(n,l,e);a[e]?(a[e].p(t,o),k(a[e],1)):(a[e]=W(t),a[e].c(),k(a[e],1),a[e].m(s,null))}for(tt(),e=l.length;e<a.length;e+=1)d(e);N()}},i(n){if(!i){for(let o=0;o<l.length;o+=1)k(a[o]);i=!0}},o(n){a=a.filter(st);for(let o=0;o<a.length;o+=1)O(a[o]);i=!1},d(n){n&&w(s),G(a,n)}}}const lt=3;function it(r){const s=r.reduce((e,t)=>e+t.x,0)/r.length,i=r.reduce((e,t)=>e+t.y,0)/r.length;let l=0,a=0,d=0;r.forEach(e=>{const t=e.x-s,c=e.y-i;l+=t*t,a+=t*c,d+=c*c});let n=.5*Math.atan2(2*a,l-d);const o=r.map(e=>{const t=e.x-s,c=e.y-i,g=t*Math.cos(-n)-c*Math.sin(-n),_=t*Math.sin(-n)+c*Math.cos(-n);return g>0?_:null}).filter(e=>e!==null);return o.length&&o.reduce((e,t)=>e+t,0)/o.length<0&&(n+=Math.PI),{angle:n,center:{x:s,y:i}}}function rt(r,s,i){const l=r.x-i.x,a=r.y-i.y;return{x:l*Math.cos(-s)-a*Math.sin(-s)+i.x,y:l*Math.sin(-s)+a*Math.cos(-s)+i.y}}function ct(r,s,i){const l=[{dataPath:"TP 261 Markt Hall-top1000.json",countPath:"TP 261 Markt Hall-top1000-count.json"},{dataPath:"TP 255 Serpentine Gallery Pavilion-top1000.json",countPath:"TP 255 Serpentine Gallery Pavilion-top1000-count.json"}];let a=Array(l.length).fill(null);const d=(o,e)=>t=>{let c=[],g=0,_=0;const h=10,m=.8,y=100,F=1900;let T=1;t.preload=()=>{t.loadJSON(o,S=>{c=Object.entries(S).map(([u,f])=>{if(!Array.isArray(f.vertices)||f.vertices.length<lt)return null;const{angle:$,center:P}=it(f.vertices),x=f.vertices.map(M=>rt(M,$,P)),p=x.map(M=>M.x),v=x.map(M=>M.y),z={minX:Math.min(...p),minY:Math.min(...v),w:Math.max(...p)-Math.min(...p),h:Math.max(...v)-Math.min(...v)};return{id:u,verts:x,bounds:z}}).filter(Boolean),T=Math.max(...c.map(u=>Math.max(u.bounds.w,u.bounds.h)),1)})},t.setup=()=>{t.createCanvas(t.windowWidth/l.length,t.windowHeight-30)},t.draw=()=>{if(t.background(255),!c.length)return;t.frameCount-_>h&&(g=(g+1)%c.length,_=t.frameCount);const{verts:S,bounds:u}=c[g],f=Math.max(u.w,u.h),$=Math.min(t.width,t.height)*m,P=t.constrain($/f,y/f,F/f),x=t.constrain(T/f,.2,1);t.push(),t.translate(t.width/2,t.height/2),t.stroke(0),t.strokeWeight(x),t.noFill(),t.noStroke(),t.fill("blue"),t.beginShape(),S.forEach(p=>{const v=(p.x-(u.minX+u.w/2))*P,z=(p.y-(u.minY+u.h/2))*P;t.vertex(v,z)}),t.endShape(t.CLOSE),t.pop()},t.windowResized=()=>{t.resizeCanvas(t.windowWidth/l.length,t.windowHeight-30)}};function n(o,e){q[o?"unshift":"push"](()=>{a[e]=o,i(0,a)})}return[a,l,d,n]}class ft extends J{constructor(s){super(),L(this,s,ct,ot,Y,{})}}export{ft as component,mt as universal};
